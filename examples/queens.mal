(* $Id: queens.mal,v 1.1 2008/11/05 11:47:49 garrigue Exp $ *)

fun check a n l =
  case l of
    [] => true
  | b :: t =>
      if a = b or a-n = b or a+n = b then false
      else check a (n+1) t
  end

fun iteri i n f =
  if i <= n then f i @ iteri (i+1) n f else []

fun search n len queens =
  if n = len then [queens] else
  begin
    val len = len+1;
    iteri 1 n
      (fn i => if check i 1 queens then search n len (i::queens) else [])
  end

fun solve n = search n 0 []
